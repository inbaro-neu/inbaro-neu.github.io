<!DOCTYPE html>
<html lang="en">

  <!-- Head -->
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    <!-- Metadata, OpenGraph and Schema.org -->
    

    <!-- Standard metadata -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Deep Dive into Logistic Regression: Analyzing Handwritten Digits | Inbar  Ofer</title>
    <meta name="author" content="Inbar  Ofer">
    <meta name="description" content="A project implementing and analyzing both binary and multinomial logistic regression models to classify handwritten digits from the MNIST dataset&lt;br&gt;&lt;b&gt;Using: &lt;/b&gt;&lt;em&gt;Logistic Regression, Python, NumPy, Matplotlib&lt;/em&gt;">
    <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website">


    <!-- Bootstrap & MDB -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous">

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

    <!-- Code Syntax Highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light">

    <!-- Styles -->
    
    <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;">
    
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="canonical" href="https://inbaro-neu.github.io/projects/ai_logistic_regression/">
    
    <!-- Dark Mode -->
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark">

    <script src="/assets/js/theme.js"></script>
    <script src="/assets/js/dark_mode.js"></script>
    

  </head>

  <!-- Body -->
  <body class="fixed-top-nav ">

    <!-- Header -->
    <header>

      <!-- Nav Bar -->
      <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
        <div class="container">
          <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Inbar </span>Ofer</a>
          <!-- Navbar Toggle -->
          <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar top-bar"></span>
            <span class="icon-bar middle-bar"></span>
            <span class="icon-bar bottom-bar"></span>
          </button>

          <div class="collapse navbar-collapse text-right" id="navbarNav">
            <ul class="navbar-nav ml-auto flex-nowrap">

              <!-- About -->
              <li class="nav-item ">
                <a class="nav-link" href="/">About</a>
              </li>
              

              <!-- Other pages -->
              <li class="nav-item ">
                <a class="nav-link" href="/projects/">Projects</a>
              </li>
              <li class="nav-item ">
                <a class="nav-link" href="/resume/">Resume</a>
              </li>

              <!-- Toogle theme mode -->
              <li class="toggle-container">
                <button id="light-toggle" title="Change theme">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
                </button>
              </li>
            </ul>
          </div>
        </div>
      </nav>

      <!-- Scrolling Progress Bar -->
      <progress id="progress" value="0">
        <div class="progress-container">
          <span class="progress-bar"></span>
        </div>
      </progress>
    </header>


    <!-- Content -->
    <div class="container mt-5">
      <!-- page.html -->
        <div class="post">

          <header class="post-header">
            <h1 class="post-title">Deep Dive into Logistic Regression: Analyzing Handwritten Digits</h1>
            <p class="post-description">A project implementing and analyzing both binary and multinomial logistic regression models to classify handwritten digits from the MNIST dataset<br><b>Using: </b><em>Logistic Regression, Python, NumPy, Matplotlib</em></p>
          </header>

          <article>
            <h2 id="project-overview">Project Overview</h2>

<p>In this project, I explore the application of logistic regression in machine learning through two distinct approaches: binary logistic regression and multinomial logistic regression. The primary goal is to classify handwritten digits from the MNIST dataset, which consists of images of size 28x28 pixels in grayscale.</p>

<h2 id="implementation-details">Implementation Details</h2>

<ul>
  <li>
<b>Languages &amp; Libraries:</b> Python, NumPy, Matplotlib for data manipulation and visualization.</li>
  <li>
<b>Data Preprocessing:</b> Handling grayscale image data, converting them into feature vectors.</li>
  <li>
<b>Model Training:</b> Applying Stochastic Gradient Descent (SGD) for optimization.</li>
</ul>

<h2 id="binary-logistic-regression">Binary Logistic Regression</h2>

<ul>
  <li>
<b>Objective:</b> Classify MNIST digits into two classes using image pixels as features.</li>
  <li>
<b>Approach:</b> Implement <code class="language-plaintext highlighter-rouge">model.BinaryLogisticRegressionModel</code> to distinguish between two specific digit classes (e.g., “7” vs. “9”), represented as “0” and “1”.</li>
  <li>
<b>Analysis:</b> Generate and analyze accuracy curves, confusion matrix, model weights, and specific erroneous predictions to understand the model’s performance and limitations.</li>
</ul>

<h3 id="insights-and-analysis">Insights and Analysis</h3>

<h4 id="accuracy-curves">Accuracy Curves</h4>

<div class="row">
    <!-- First Image -->
    <div class="col-md-6 mt-3">
        <figure>

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/binary-train-accuracy-curve.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Train accuracy curve" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

        <div class="caption">
            Train accuracy curve.
        </div>
    </div>

    <!-- Second Image -->
    <div class="col-md-6 mt-3">
        <figure>

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/binary-test-accuracy-curve.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Test accuracy curve" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

        <div class="caption">
            Test accuracy curve.
        </div>
    </div>
</div>

<h4 id="confusion-matrix">Confusion Matrix</h4>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <figure>

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/binary-confusion-matrix.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Confusion Matrix" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

    </div>
</div>

<p>Accuracy: 93.9617% (1914 out of 2037)</p>

<p>Confusion Matrix:</p>
<table>
    <tr>
        <th></th>
        <th>7</th>
        <th>9</th>
    </tr>
    <tr>
        <th>7</th>
        <td>946</td>
        <td>82</td>
    </tr>
    <tr>
        <th>9</th>
        <td>41</td>
        <td>968</td>
    </tr>
</table>

<h4 id="non-bias-term-weights">Non-Bias Term Weights</h4>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <figure>

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/binary-non-bias-term-weights.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Non-Bias Term Weights" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>

    </div>
</div>

<ul>
  <li>The color bar on the right indicates the scale of the weights. In this heatmap, colors closer to the top of the color bar (yellows and greens) represent higher weights, while colors towards the bottom (blues and purples) represent lower weights. Yellow indicates strong positive weights, and purple indicates strong negative weights.</li>
  <li>
<b>Positive Weights (Yellow):</b> These areas are where the pixel values significantly contribute to the model predicting the digit as a 7. It means that for pixels in these regions, the presence of a certain intensity (white since it’s a typical black-on-white handwriting dataset) will push the model towards identifying a 7.</li>
  <li>
<b>Negative Weights (Purple):</b> These areas are where the pixel values contribute to the model predicting the digit as a 9. It implies that for these pixels, a certain intensity (black) will push the model towards identifying a 9.</li>
  <li>
<b>Neutral Weights (Green/Blue):</b> These pixels don’t have much influence on the differentiation between 7 and 9, meaning that their values do not significantly sway the model towards either digit.</li>
  <li>The model uses these weights to decide whether a new, unseen image of a digit is more likely to be a 7 or a 9. When it ‘sees’ an image, it will multiply the pixel values by these weights to reach a decision.</li>
</ul>

<h4 id="analysis-of-erroneous-predictions">Analysis of Erroneous Predictions</h4>

<table>
    <tr>
        <td>
<figure>

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/error1.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Non-Bias Term Weights" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>
</td>
        <td>
<figure>

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/error2.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Non-Bias Term Weights" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>
</td>
        <td>
<figure>

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/error3.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Non-Bias Term Weights" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>
</td>
        <td>
<figure>

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/error4.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Non-Bias Term Weights" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>
</td>
        <td>
<figure>

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/error5.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Non-Bias Term Weights" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>
</td>
    </tr>
    <tr>
        <td>
<figure>

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/error6.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Non-Bias Term Weights" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>
</td>
        <td>
<figure>

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/error7.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Non-Bias Term Weights" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>
</td>
        <td>
<figure>

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/error8.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Non-Bias Term Weights" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>
</td>
        <td>
<figure>

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/error9.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Non-Bias Term Weights" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>
</td>
        <td>
<figure>

  <picture>
    

    <!-- Fallback to the original file -->
    <img src="/assets/img/error10.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="Non-Bias Term Weights" onerror="this.onerror=null; $('.responsive-img-srcset').remove();">

  </picture>

</figure>
</td>
    </tr>
</table>

<p>Some potential reasons why the model made errors on these cases/what it failed to capture:</p>
<ul>
  <li>Ambiguity in Digit Formation: If the shapes are not clearly defined or have ambiguous features that could belong to multiple digits, the model might be confused. For example, if a ‘9’ is written with a very small loop, it might resemble a ‘7’.</li>
  <li>Noise and Distortions: Variability in writing style, such as slants, loops, or breaks in the strokes, can introduce noise that the model fails to handle well.</li>
  <li>Model’s Feature Sensitivity: The model may not be sensitive to certain features that differentiate the digits. For example, the intersection in the ‘7’ or the loop in the ‘9’.</li>
</ul>

<p>Additional features that may help the model make correct predictions on these error cases:</p>
<ul>
  <li>Contextual Features: Incorporating context, like the relative position of loops and lines, could help distinguish between similar digits.</li>
  <li>Stroke Analysis: Analyzing the order and direction of strokes could provide more insight into the intended digit.</li>
  <li>Structural Decomposition: Breaking down the digit into constituent parts and analyzing the presence or absence of these parts (like the crossbar in a ‘7’ or the loop in a ‘9’).</li>
  <li>Convolutional Features: Using Convolutional Neural Networks (CNNs) to capture spatial hierarchies in the data that simple weight matrices might miss.</li>
  <li>Data Augmentation: Increasing the diversity of the training data by introducing variations in digit representation, such as rotations, scaling, and noise.</li>
  <li>Complexity Control: Applying regularization techniques to prevent overfitting to the training data.</li>
  <li>Error Analysis: Conducting a thorough error analysis to understand the specific cases where the model fails and adapting the training strategy accordingly.</li>
  <li>Ensemble Methods: Using ensemble methods that combine the predictions of multiple models to improve accuracy.</li>
  <li>Human-like Feature Extraction: Incorporating features that mimic human visual perception, such as recognizing overall shape patterns before focusing on details.</li>
</ul>

<h2 id="multinomial-logistic-regression">Multinomial Logistic Regression</h2>

<ul>
  <li>
<b>Objective:</b> Extend classification to all 10 digit classes in the MNIST dataset.</li>
  <li>
<b>Approach:</b> Utilize <code class="language-plaintext highlighter-rouge">model.MultiLogisticRegressionModel</code> for a more comprehensive classification covering all digits from “0” to “9”.</li>
  <li>
<b>Analysis:</b> Similar to the binary case, this section involves plotting training and test accuracy curves, confusion matrices, and an examination of the learned weights for all digit classes.</li>
  <li>
<b>Performance Optimization:</b> Due to the larger scale of data (60K training images and 10K test images), strategies such as training on a fraction of the data and using fewer iterations during development and debugging are employed for efficient performance without compromising accuracy​.</li>
</ul>

          </article>

        </div>

    </div>

    <!-- Footer -->    
    <footer class="fixed-bottom">
      <div class="container mt-0">
        © Copyright 2023 Inbar  Ofer. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>.

      </div>
    </footer>

    <!-- JavaScripts -->
    <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <!-- Bootsrap & MDB scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script>

    <!-- Masonry & imagesLoaded -->
  <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
  <script defer src="/assets/js/masonry.js" type="text/javascript"></script>
    
  <!-- Medium Zoom JS -->
  <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script>
  <script defer src="/assets/js/zoom.js"></script><!-- Load Common JS -->
  <script defer src="/assets/js/common.js"></script>
  <script defer src="/assets/js/copy_code.js" type="text/javascript"></script>

    
  <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script>
  <script async src="https://badge.dimensions.ai/badge.js"></script>

    <!-- MathJax -->
  <script type="text/javascript">
    window.MathJax = {
      tex: {
        tags: 'ams'
      }
    };
  </script>
  <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
  <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>

    
    

<!-- Scrolling Progress Bar -->
<script type="text/javascript">
  /*
   * This JavaScript code has been adapted from the article 
   * https://css-tricks.com/reading-position-indicator/ authored by Pankaj Parashar, 
   * published on the website https://css-tricks.com on the 7th of May, 2014.
   * Couple of changes were made to the original code to make it compatible 
   * with the `al-foio` theme.
   */
  const progressBar = $("#progress");
  /*
   * We set up the bar after all elements are done loading.
   * In some cases, if the images in the page are larger than the intended
   * size they'll have on the page, they'll be resized via CSS to accomodate
   * the desired size. This mistake, however, breaks the computations as the
   * scroll size is computed as soon as the elements finish loading.
   * To account for this, a minimal delay was introduced before computing the
   * values.
   */
  window.onload = function () {
    setTimeout(progressBarSetup, 50);
  };
  /*
   * We set up the bar according to the browser.
   * If the browser supports the progress element we use that.
   * Otherwise, we resize the bar thru CSS styling
   */
  function progressBarSetup() {
    if ("max" in document.createElement("progress")) {
      initializeProgressElement();
      $(document).on("scroll", function() {
        progressBar.attr({ value: getCurrentScrollPosition() });
      });
      $(window).on("resize", initializeProgressElement);
    } else {
      resizeProgressBar();
      $(document).on("scroll", resizeProgressBar);
      $(window).on("resize", resizeProgressBar);
    }
  }
  /*
   * The vertical scroll position is the same as the number of pixels that
   * are hidden from view above the scrollable area. Thus, a value > 0 is
   * how much the user has scrolled from the top
   */
  function getCurrentScrollPosition() {
    return $(window).scrollTop();
  }

  function initializeProgressElement() {
    let navbarHeight = $("#navbar").outerHeight(true);
    $("body").css({ "padding-top": navbarHeight });
    $("progress-container").css({ "padding-top": navbarHeight });
    progressBar.css({ top: navbarHeight });
    progressBar.attr({
      max: getDistanceToScroll(),
      value: getCurrentScrollPosition(),
    });
  }
  /*
   * The offset between the html document height and the browser viewport
   * height will be greater than zero if vertical scroll is possible.
   * This is the distance the user can scroll
   */
  function getDistanceToScroll() {
    return $(document).height() - $(window).height();
  }

  function resizeProgressBar() {
    progressBar.css({ width: getWidthPercentage() + "%" });
  }
  // The scroll ratio equals the percentage to resize the bar
  function getWidthPercentage() {
    return (getCurrentScrollPosition() / getDistanceToScroll()) * 100;
  }
</script>

  </body>
</html>
